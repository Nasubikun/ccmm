# ccmm push コマンドのインタラクティブ選択機能実装

## 実装日時
2025-06-15

## 問題点
ユーザーが`ccmm push`を引数なしで実行した際、エラーメッセージ`error: missing required argument 'preset'`だけでは何をすべきかわからず、使いづらい。

## 解決策
改善案1（インタラクティブ選択）を実装：
- 引数なしで`ccmm push`を実行した場合、利用可能なプリセット一覧を表示し、インタラクティブに選択できるようにする
- 単一プリセットの場合は自動選択
- 変更のないプリセットは選択不可として表示

## 実装内容

### 1. CLI定義の変更 (src/cli/index.ts)
```typescript
// preset引数をオプショナルに変更
.argument("[preset]", "プッシュするプリセット名（未指定時は選択UI表示）")
```

### 2. 新規追加関数 (src/cli/push.ts)

#### getPushablePresets関数
- プロジェクトの現在のプリセット一覧を取得
- 各プリセットの変更有無をチェック
- プッシュ可能なプリセット情報を返す

#### selectPresetInteractive関数
- inquirerを使用してインタラクティブな選択UI提供
- 単一プリセットの場合は自動選択
- 変更のあるプリセットのみ選択可能

### 3. push関数の改修
- 引数なし・空文字列の場合の処理を追加
- プロジェクトのプリセット設定から自動的にプリセット情報を取得
- インタラクティブ選択後、既存の処理フローに接続

### 4. エラーメッセージの改善
- プリセットが設定されていない場合：セットアップガイドを表示
- 変更のないプリセットしかない場合：利用可能なプリセット一覧と次のアクションを提示

## 動作例

### 引数なしで実行（複数プリセット）
```bash
$ ccmm push
? プッシュするプリセットを選択してください:
❯ react.md (myorg/CLAUDE-md) ※変更あり
  typescript.md (myorg/CLAUDE-md)
  nextjs.md (myorg/CLAUDE-md) ※変更あり
```

### 引数なしで実行（単一プリセット）
```bash
$ ccmm push
プリセット 'react.md' を自動選択しました
[プッシュ処理継続...]
```

### 変更がない場合
```bash
$ ccmm push

利用可能なプリセット:
  - react.md (myorg/CLAUDE-md)
  - typescript.md (myorg/CLAUDE-md)

変更のあるプリセットがありません。
'ccmm edit <preset>' でプリセットを編集してから再度実行してください。
```

## テスト結果
- push.test.ts: 全24テスト成功
- 統合テストの一部失敗は既存の問題（syncコマンド関連）で、今回の変更とは無関係

## 今後の改善案
- `--all` オプションで変更のある全プリセットを一括プッシュ
- 差分の詳細表示オプション
- プッシュ前の確認プロンプト（-yでスキップ可能）