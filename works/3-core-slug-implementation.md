# 3. core/slug.ts 実装

## 実装内容

Git origin URLからプロジェクト識別用のスラッグを生成する `makeSlug` 関数を実装。

### 主要機能

1. **URL解析** - 複数のGit URL形式に対応
   - HTTPS形式: `https://github.com/owner/repo.git`
   - SSH形式: `git@github.com:owner/repo.git`
   - SSH URL形式: `ssh://git@github.com/owner/repo.git`
   - GitLab等の他ホスト対応

2. **正規化** - 一貫性のあるスラッグ生成
   - `.git` 拡張子の有無を統一
   - 前後の空白文字を除去
   - 正規化されたURL形式でハッシュ化

3. **スラッグ生成** - requirements.mdの仕様に準拠
   - `host__owner__repo-git-<originSHA>` の形式でソース文字列を構築
   - SHA-256ハッシュの最初の16文字を使用
   - ディレクトリ名として使いやすい長さに調整

### 実装の特徴

- **関数ベース設計** - CLAUDE.mdの指針に従い、クラスを使わず関数で実装
- **エラーハンドリング** - 未対応URL形式で明確なエラー
- **冪等性** - 同じURLから常に同じスラッグを生成
- **一意性** - 異なるURLから異なるスラッグを生成

### テスト

vitestを使用して包括的なテストを実装：
- URL形式パース（5種類）
- エラーハンドリング（3パターン）
- 冪等性と一意性（4パターン）
- URL正規化（2パターン）

全12テストが合格し、実装の正確性を確認。

### 技術的な判断

**originSHAの生成方法**
- 当初は元のURLをそのままハッシュ化していたが、正規化テストの失敗で問題発見
- 解決策：パース後の構成要素から正規化URLを再構築してハッシュ化
- これにより`.git`有無や空白の違いを吸収

**ハッシュ長の選択**
- SHA-256の最初の16文字（64bit相当）
- 衝突確率は十分低く、ディレクトリ名として適切な長さ

### 次のステップ

core/fs.ts の実装に進む。slug.tsは他のモジュールの基盤となる機能なので、この完成により後続実装が円滑に進むと期待。